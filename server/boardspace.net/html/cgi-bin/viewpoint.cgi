#!/usr/bin/perl


#  PROJECT HONEY POT ADDRESS DISTRIBUTION SCRIPT
#  For more information visit: http://www.projecthoneypot.org/
#  Copyright (C) 2004, Unspam, LLC
#  
#  This program is free software; you can redistribute it and/or modify
#  it under the terms of the GNU General Public License as published by
#  the Free Software Foundation; either version 2 of the License, or
#  (at your option) any later version.
#  
#  This program is distributed in the hope that it will be useful,
#  but WITHOUT ANY WARRANTY; without even the implied warranty of
#  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#  GNU General Public License for more details.
#  
#  You should have received a copy of the GNU General Public License
#  along with this program; if not, write to the Free Software
#  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA
#  02111-1307  USA
#  
#  If you choose to modify or redistribute the software, you must
#  completely disconnect it from the Project Honey Pot Service, as
#  specified under the Terms of Service Use. These terms are available
#  here:
#  
#  http://www.projecthoneypot.org/terms_of_service_use.php
#  
#  The required modification to disconnect the software from the
#  Project Honey Pot Service is explained in the comments below. To find the
#  instructions, search for:  *** DISCONNECT INSTRUCTIONS ***
#  
#  Generated On: Fri, 11 Feb 2005 20:13:46 -0600
#  For Domain: www.boardspace.net
#  
#  
use strict;
use Digest::MD5 qw(md5_hex);



#  *** DISCONNECT INSTRUCTIONS ***
#  
#  You are free to modify or redistribute this software. However, if
#  you do so you must disconnect it from the Project Honey Pot Service.
#  To do this, you must delete the lines of code below located between the
#  *** START CUT HERE *** and *** FINISH CUT HERE *** comments. Under the
#  Terms of Service Use that you agreed to before downloading this software,
#  you may not recreate the deleted lines or modify this software to access
#  or otherwise connect to any Project Honey Pot server.
#  
#  *** START CUT HERE ***
#  
my $__REQUEST_HOST    = 'hpr8.projecthoneypot.org';
my $__REQUEST_PORT    = '80';
my $__REQUEST_SCRIPT  = '/cgi/serve.php';
#  
#  *** FINISH CUT HERE ***
#  

my $__HPOT_TAG1       = '10c701432da2568a6a2514b9d6513265';
my $__HPOT_TAG2       = '3949b62b8dc4812f7345828038415218';
my $__HPOT_TAG3       = '60eff423c208d7fdab40a0dd2d377e0b';

my $__CLASS_STYLE_1   = 'veyufrab';
my $__CLASS_STYLE_2   = 'phamo';

my $__DIV1            = '32tradr7b';

my $__VANITY_L1       = 'MEMBER OF PROJECT HONEY POT';
my $__VANITY_L2       = 'Spam Harvester Protection Network';
my $__VANITY_L3       = 'provided by Unspam';

my $__DOC_TYPE1       = '<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">\n';
my $__HEAD1           = '<html>\n<head>\n';
my $__HEAD2           = '<title>http://www.boardspace.net</title>\n</head>\n';
my $__ROBOT1          = '<meta name="robots" content="follow,noindex,noarchive">\n';
my $__NOCOLLECT1      = '<meta name="no-email-collection" content="/" />\n';
my $__TOP1            = '<body>\n<div align="center" id="falcate">\n';
my $__EMAIL1A         = '<a href="mailto:';
my $__EMAIL1B         = '" style="display: none;">';
my $__EMAIL1C         = '</a>';
my $__EMAIL2A         = '<a href="mailto:';
my $__EMAIL2B         = '" style="display:none;">';
my $__EMAIL2C         = '</a>';
my $__EMAIL3A         = '<a style="display: none;" href="mailto:';
my $__EMAIL3B         = '">';
my $__EMAIL3C         = '</a>';
my $__EMAIL4A         = '<a style="display:none;" href="mailto:';
my $__EMAIL4B         = '">';
my $__EMAIL4C         = '</a>';
my $__EMAIL5A         = '<a href="mailto:';
my $__EMAIL5B         = '"></a>';
my $__EMAIL5C         = '..';
my $__EMAIL6A         = '<span style="display: none;"><a href="mailto:';
my $__EMAIL6B         = '">';
my $__EMAIL6C         = '</a></span>';
my $__EMAIL7A         = '<span style="display:none;"><a href="mailto:';
my $__EMAIL7B         = '">';
my $__EMAIL7C         = '</a></span>';
my $__EMAIL8A         = '<!-- <a href="mailto:';
my $__EMAIL8B         = '">';
my $__EMAIL8C         = '</a> -->';
my $__EMAIL9A         = '<div id="'.$__DIV1.'"><a href="mailto:';
my $__EMAIL9B         = '">';
my $__EMAIL9C         = '</a></div><br><script language="JavaScript" type="text/javascript">document.getElementById(\''.$__DIV1.'\').innerHTML=\'\';</script>';
my $__EMAIL10A        = '<a href="mailto:';
my $__EMAIL10B        = '"><!-- ';
my $__EMAIL10C        = ' --></a>';
my $__LEGAL1          = '';
my $__LEGAL2          = '\n';
my $__STYLE1          = '\n<style>a.'.$__CLASS_STYLE_1.'{color:#FFF;font:bold 10px arial,sans-serif;text-decoration:none;}</style>';
my $__VANITY1         = '<table cellspacing="0"cellpadding="0"border="0"style="background:#999;width:230px;"><tr><td valign="top"style="padding: 1px 2px 5px 4px;border-right:solid 1px #CCC;"><span style="font:bold 30px arial,sans-serif;color:#666;top:0px;position:relative;">@</span></td><td valign="top" align="left" style="padding:3px 0 0 4px;"><a href="http://www.projecthoneypot.org/" class="'.$__CLASS_STYLE_1.'">'.$__VANITY_L1.'</a><br><a href="http://www.unspam.com"class="'.$__CLASS_STYLE_1.'">'.$__VANITY_L2.'<br>'.$__VANITY_L3.'</a></td></tr></table>\n';
my $__BOTTOM1         = '</div>\n</body>\n</html>\n';


sub getLegalContent() { return '<table cellspacing="0" border="0" cellpadding="0">\n<tr>\n<td><div style="font-family: courier, monospace;"><b><font color=#FFFFFF>k</font></b>&nbsp;&nbsp; <br>&nbsp;<br>The <br>to y<br>&#111;the<br>Webs<br>read<br>agen<br>them<br>n&#111;n-<br>Webs<br><br>&nbsp; &nbsp; <br>&nbsp;<br>Spec<br>Non-<br>spi&#100;<br>&#112;rog<br>a&#117;&#116;o<br><br>Ema&#105;<br>It i<br>al&#111;n<br>h&#97;s<font color=#FFFFFF>f</font><br>st&#111;r<br>valu<br>s&#116;or<br>agre<br><br>&nbsp; &nbsp; <br>&nbsp;<br>Each<br>agai<br>("&#74;u<br>t&#104;e <br>such<br>and <br>of f<br>any <br>Se&#114;v<br>&#116;he <br><br>&nbsp;<b><font color=#FFFFFF>e</font></b>&nbsp;<b><font color=#FFFFFF>k</font></b><br>&nbsp;<br>Y&#111;&#117; <br>&#109;&#97;y <br>abus<!-- fusion limited global --><br>Vi&#115;i<br><br>&#86;I&#83;I<br>PART<br>SUBS<br></div></td>\n<td><div style="font-family: courier, monospace;">&nbsp; &nbsp; <br><br>webs<br>ou s<br>r te<br>ite <br>&nbsp;t&#104;e<br>t<!-- emphasis envelope vestigial -->s &#111;<br>&#46; Th<br>tran<br>ite&#46;<br><br>&nbsp; &nbsp; <br><br>ial <br>H&#117;ma<br>&#101;rs&#44;<br>rams<br>mat&#105;<br><br>l &#97;d<br>s<font color=#FFFFFF>i</font>re<br>e&#46; Y<br>a va<br>a&#103;e<!-- alaking volcanic offroad feigned -->&#44;<br>e of<br>ing <br>&#101;&#109;en<br><br>&nbsp;<b><font color=#FFFFFF>g</font></b>&nbsp; <br><br>&nbsp;par<br>nst <br>di&#99;i<br>reg&#105;<br>&nbsp;law<br>&#112;e&#114;f<br>eder<br>acti<br>ice.<br>abov<br><br>&nbsp; &nbsp; <br><br>cons<br>appe<br>e. T<br>to&#114;s<br><br>TOR&#83;<br>Y OR<br>EQUE<br></div></td>\n<td><div style="font-family: courier, monospace;">&nbsp;&nbsp; <b><font color=#FFFFFF>i</font></b><br><br>ite <br>ubje<br>rms <br>you <br>m<!-- curator mouse phone -->&nbsp;ca<br>f<!-- knowing nutritious under conversion -->&nbsp;th<br>e ac<br>sf&#101;r<br><br><br>&nbsp; &nbsp; <br><br>rest<br>n<font color=#FFFFFF>k</font>&#86;i<br>&nbsp;&#98;ot<br>&nbsp;d&#101;s<br>call<br><br>d&#114;es<br>cogn<br>ou a<br>lue <br>&nbsp;and<br>&nbsp;t&#104;&#101;<br>this<br>t an<br><br>&nbsp; &nbsp; <br><br>ty a<br>the <br>al A<br>ster<br>s ar<br>or&#109;e<br>al a<br>&#111;n b<br>&nbsp;You<br>e ag<br><br>&nbsp; &nbsp; <br><br>ent <br>ar &#115;<br>he I<br>&nbsp;a&#103;r<br><br>&nbsp;AGR<br>&nbsp;SEN<br>N&#84; B<br></div></td>\n<td><div style="font-family: courier, monospace;">&nbsp; <b><font color=#FFFFFF>p</font><font color=#FFFFFF>f</font></b><br><br>from<br>ct t<br>gove<br>acce<br>re&#102;u<br>e &#105;n<br>cess<br>able<br><br><br>&nbsp; <b><font color=#FFFFFF>o</font>S</b><br><br>&#114;ict<br>sito<br>&#115;, i<br>igne<br>y.<br><br>s&#101;s <br>i<!-- universe scared recognition diamond -->zed<br>ckno<br>not <br>/or <br>&#115;e a<br>&nbsp;W&#101;b<br>d ex<br><br>&nbsp; &nbsp; <br><br>gree<br>oth&#101;<br>c&#116;io<!-- unfair --><br>ed &#65;<br>e a&#112;<br>d en<br>n&#100; s<br>roug<br><font color=#FFFFFF>h</font>con<br>&#114;e&#101;m<br><br>&nbsp; <b><font color=#FFFFFF>g</font></b>&nbsp;<br><br>to h<br>omew<br>den&#116;<br>ee n<!-- lawn telling numerous free --><br><br>EE<font color=#FFFFFF>h</font>T<br>D&#73;NG<br>REA&#67;<br></div></td>\n<td><div style="font-family: courier, monospace;"><b><font color=#FFFFFF>d</font><font color=#FFFFFF>d</font></b>&nbsp; <br><br>&nbsp;w&#104;i<br>&#111;<font color=#FFFFFF>s</font>&#116;h<!-- vagrant patent ratty --><br>rni<!-- quadrivalent tangy hungry highrise -->n<br>pt t<br>&#108;ly.<br>&#100;iv&#105;<br>&nbsp;&#114;ig<br><font color=#FFFFFF>f</font>wit<br><br><br><b>P&#69;CI</b><br><br>ions<br>rs&#46; <br>ndex<br>d<font color=#FFFFFF>p</font>to<br><br><br>on<font color=#FFFFFF>e</font>&#116;<br>&nbsp;tha<br>wl&#101;d<br>less<br>dis&#116;<br>d&#100;re<br>site<br>pre&#115;<br><br>&nbsp; &nbsp; <br><br>s th<br>r in<br>n")<font color=#FFFFFF>h</font><br>d&#109;in<!-- meat aspiring hammer --><br>plie<br>tire<br>tate<br>h&#116; a<br>sent<br>en&#116;&#46;<br><br>&nbsp; &nbsp; <br><br>avin<br>her&#101;<br>i&#102;ie<br>ot t<br><br>HAT <br>&nbsp;ANY<br>H OF<br></div></td>\n<td><div style="font-family: courier, monospace;"><b><font color=#FFFFFF>p</font><font color=#FFFFFF>p</font></b>&nbsp; <br><br>ch &#121;<br>e f&#111;<br>g ac<br>hese<br>&nbsp;Any<br>d<!-- historic scary abstract copy minus -->u<!-- irate horror -->&#97;l<br>hts <br>hout<br><br><br><b>AL</b>&nbsp;<b>L</b><br><br>&nbsp;on <br>N&#111;n-<br>ers,<br>&nbsp;acc<br><br><br>his <br>t<!-- okay banister lobed occasional -->&nbsp;th<br>ge<font color=#FFFFFF>f</font>a<br>&nbsp;&#116;h&#97;<br>ribu<br>sses<br>\'s e<br>sly <br><br>&nbsp; &nbsp; <br><br>at a<br>&nbsp;c&#111;n<br>shal<br>i<!-- candid marine right illustration -->s<!-- rise -->t&#114;<br>d to<br>ly w<br>&nbsp;cou<br>gain<br>&nbsp;to<font color=#FFFFFF>t</font><br><br><br><b><font color=#FFFFFF>d</font></b>&nbsp;&nbsp; <br><br>g yo<!-- computing difficult --><br>&nbsp;on <br>r is<br>o us<br><br>HARV<br>&nbsp;MES<br>&nbsp;THE<br></div></td>\n<td><div style="font-family: courier, monospace;">&nbsp; <b><font color=#FFFFFF>i</font>T</b><br><br>ou a<br>llo&#119;<br>ces&#115;<br>&nbsp;ter<br>&nbsp;Non<br>(s) <br>gran<br>&nbsp;the<br><br><br><b>ICEN</b><br><br>a v&#105;<br>&#72;uma<br>&nbsp;rob<br>es<!-- haploid photographic sopranino -->s&#44;<br><br><br>&#115;&#105;te<br>&#101;se <br>nd a<br>n US<br>tio&#110;<br>. &#73;n<br>mail<br>proh<br><br>&nbsp;<b>APP</b><br><br>n&#121; s<br>nect<br>&#108; be<br>a&#116;iv<br>&nbsp;ag&#114;<br>&#105;thi<br>rt&#115; <br>st h<br>e&#108;ec<br><br><br><b>RECO</b><br><br>ur I<br>&#116;his<br>&nbsp;uni<br>e &#116;h<br><br>&#69;STI<!-- wet affection --><br>S&#65;&#71;E<br>S&#69; T<br></div></td>\n<td><div style="font-family: courier, monospace;"><b>&#69;RMS</b><br><br>cc&#101;s<br>ing <br>&nbsp;to<!-- confrontation offline --><font color=#FFFFFF>p</font><br>&#109;s<font color=#FFFFFF>e</font>a<br>-Hum<br>who <br>&#116;e&#100; <br>&nbsp;exp<br><br><br><b>SE</b>&nbsp;<b>R</b><br><br>sito<br>n &#86;i<br>ot&#115;,<br>&nbsp;rea<br><br><br>&nbsp;are<br>e&#109;ai<br>gree<br>&nbsp;$50<br><font color=#FFFFFF>e</font>of<font color=#FFFFFF>i</font><br>ten&#116;<br>&nbsp;ad&#100;<br>ibit<br><br><b>LI&#67;A</b><br><br>uit,<br>ion <br>&nbsp;gov<br>e Co<br>eem&#101;<br>&#110; th<br>wit&#104;<br>im i<br>tron<br><br><br><b>RDS<font color=#FFFFFF>o</font></b><br><br>nt&#101;r<br>&nbsp;pag<br>quel<br>is a<br><br>NG, <br>(S) <br>&#69;RMS<br></div></td>\n<td><div style="font-family: courier, monospace;">&nbsp;<b>A&#78;D</b><br><br>se&#100; <br>&#99;ond<br>&#116;he <br>nd c<br>an V<br>&#99;ont<br>to<font color=#FFFFFF>e</font>y<br>ress<br><br><br><b>E&#83;TR</b><br><br>r\'s <br>&#115;ito<br>&nbsp;cra<br>d, c<br><br><br>&nbsp;&#99;&#111;n<br>l ad<br>&nbsp;tha<br>. Yo<br>the&#115;<br>iona<br>ress<br>ed.<br><br><b>BLE</b>&nbsp;<br><br>&nbsp;ac<!-- liberty -->t<br>wit&#104;<br>&#101;rne<br>ntac<br>nts <br>&#101; &#65;d<br>in t<br>&#110; &#99;o<br>ic s<br><br><br><b>O<!-- lordly getaway tea -->F<font color=#FFFFFF>a</font>V</b><br><br>net<font color=#FFFFFF>k</font><br>e (&#116;<br>y<font color=#FFFFFF>i</font>ma<br>ddre<br><br>GATH<br>TO &#84;<br>&nbsp;OF<font color=#FFFFFF>i</font><br></div></td>\n<td><div style="font-family: courier, monospace;"><b><font color=#FFFFFF>k</font>CON</b><br><br>this<br>iti&#111;<br>We<!-- reasonable fellow flashy -->bs<br>ondi<br>is&#105;t<br>rols<br>ou u<br>&nbsp;wri<br><br><br><b>&#73;CT&#73;</b><br><br>lice<br>rs i<br>wler<br>ompi<br><br><br>side<br>&#100;res<br>t ea<br>u fu<br>e ad<br>l co<br>es i<br><br><br><b>LAW</b>&nbsp;<br><br>ion <br>&nbsp;or <br>d by<br>t &#40;&#116;<br>betw<br>min <br>&#104;e A<br>n&#110;ec<br>ervi<br><br><br><b>I&#83;&#73;T</b><br><br>Prot<br>he "<br>&#116;che<br>s&#115; f<br><br>ERI&#78;<br>HE &#73;<br>S&#69;R<!-- faultfinding cuspidate shed catholic sector -->V<br></div></td>\n<td><div style="font-family: courier, monospace;"><b>DITI</b><br><br>&nbsp;agr<br>&#110;s. <br>ite.<br>tion<br>ors <br>, au<br>nd&#101;r<br>tten<br><br><br><b>ONS</b>&nbsp;<br><br>nse <br>nclu<br>s&#44; h<br>le o<br><br><br>red <br>ses <br>c&#104; e<br>rthe<br>dre<!-- apple odor -->s<br>lle&#99;<br>s r&#101;<br><br><br><b>AND</b>&nbsp;<br><br>or p<br>a&#114;is<br>&nbsp;the<br>he "<br>een <br>Stat<br>dmin<br>tio&#110;<br>ce o<br><br><br><b>&#79;&#82;<font color=#FFFFFF>h</font>U</b><br><br>&#111;c&#111;&#108;<br>Id&#101;n<br>d to<br>o<!-- illtimed -->r a<br><br>G, S<br>DENT<br>ICE.<br></div></td>\n<td><div style="font-family: courier, monospace;"><b>O&#78;S<font color=#FFFFFF>f</font></b><br><br>&#101;eme<br>Thes<br>&nbsp;By <br>s &#40;t<br>to t<br>thor<br>&nbsp;the<br><font color=#FFFFFF>c</font>per<br><br><br><b>FOR</b>&nbsp;<br><br>to a<br>de&#44;<font color=#FFFFFF>p</font><br>ar&#118;e<br>r ga<br><br><br>prop<br>are <br>mail<br>&#114; ag<br>ses <br>&#116;ion<br>cogn<br><br><br><b>JURI</b><br><br>r&#111;&#99;e<br>i&#110;g <br>&nbsp;law<br>A&#100;mi<br>Admi<br>e&#46; &#89;<br><font color=#FFFFFF>s</font>Sta<br>&nbsp;wit<br>&#102; &#112;r<br><br><br><b>S&#69;</b>&nbsp;<b>A</b><br><br>&nbsp;add<br>tifi<br>&nbsp;you<br>ny &#114;<br><br>&#84;ORI<br>IFIE<br><br></div></td>\n<td><div style="font-family: courier, monospace;"><b>OF</b>&nbsp;<b>&#85;</b><br><br>n&#116; (<br>e te<br>v&#105;si<br>&#104;e "<br>he W<br>&#115; or<br>&nbsp;Ter<br>miss<br><br><br><b>&#78;ON-</b><br><br>cce<!-- golf misleading -->s<br>bu&#116; <br>ster<br>&#116;&#104;er<br><br><br>rie&#116;<br>p&#114;ov<br>&nbsp;add<!-- performer actors prejudicial --><br>ree <br>subs<br>, &#104;a<br>iz<!-- rakish dramatic emotional orange -->&#101;d<br><br><br><b>SD<!-- hoc celebration -->I<!-- moderate doublefaced -->C</b><br><br>edin<br>from<br>&nbsp;of <br>n St<br>n St<br>ou c<br>te&#46; <br>h &#98;r<br>oce&#115;<br><br><br><b>ND</b>&nbsp;<b>A</b><br><br>ress<br>er")<br>&#114; In<br>easo<br><br>NG&#44; <br>R C&#79;<br><br></div></td>\n<td><div style="font-family: courier, monospace;"><b>SE</b>&nbsp;<br><br>"t<!-- bird constitutional -->he<br>rms <br>&#116;ing<br>Term<br>ebs&#105;<br>&nbsp;ot&#104;<br>ms<font color=#FFFFFF>p</font>o<br>i&#111;n <br><br><br><b>HUMA</b><br><br>s th<br>are <br>s, o<br>&nbsp;con<br><br><br>&#97;&#114;y <br>ided<br>re&#115;s<br>t<!-- monotypic orchestra nameless low inclined -->hat<br>tant<br>rves<br>&nbsp;as <br><br><br><b>TION</b><br><br>g br<br><font color=#FFFFFF>s</font>t&#104;e<br>&#116;h<!-- underage juvenile banister -->e <br>ate"<br>ate <br>onse<br>You <br>each<br>s r&#101;<br><br><br><b>&#66;USE</b><br><br><font color=#FFFFFF>c</font>r&#101;c<br>&nbsp;i&#102;<font color=#FFFFFF>a</font><br>tern<br>n.<br><br>TR&#65;N<br>NSTI<br><br></div></td>\n<td><div style="font-family: courier, monospace;"><br><br>&nbsp;We&#98;<br>are <br>&nbsp;(in<br>s &#111;f<br>te s<br>&#101;r&#119;i<br>&#102; Se<br>&#111;f<font color=#FFFFFF>f</font>&#116;<br><br><br><b>N</b>&nbsp;<b>V&#73;</b><br><br>e<font color=#FFFFFF>d</font>We<br>no&#116; <br>r<font color=#FFFFFF>o</font>an<br>t&#101;nt<br><br><br>&#105;nte<br>&nbsp;for<br>&nbsp;the<br>&nbsp;the<br>iall<br>&#116;ing<br>a v&#105;<br><br><br>&nbsp;<br><br>ough<br>&nbsp;Ter<br>stat<br>) fo<br>resi<!-- lesser revision fricative poison --><br>nt t<br>c&#111;ns<br>e&#115;<font color=#FFFFFF>o</font>o<br>gard<br><br><br>&nbsp;<br><br>orde<br>we s<br>et P<br><br><br>S&#70;&#69;R<br>TUTE<br><br></div></td>\n<td><div style="font-family: courier, monospace;"><br><br>&#115;&#105;te<br>i&#110; a<br>&nbsp;any<br>&nbsp;Ser<br>hall<br>se m<br>rvic<br>he<font color=#FFFFFF>p</font>&#111;<br><br><br><b>SI<!-- nationality fey -->&#84;O</b><br><br>bsit<br>li&#109;i<br>y ot<br>&nbsp;fro<br><br><br>llec<br><font color=#FFFFFF>g</font>hum<br>&nbsp;We&#98;<br>&nbsp;com<br>y di<br>, ga<br>ol&#97;t<br><br><br><br><br>t by<br>ms o<br>e<font color=#FFFFFF>p</font>of<br>r<font color=#FFFFFF>i</font>t&#104;<br>dent<br>o t&#104;<br>ent <br>f th<br>ing <br><br><br><br><br>d. A<br>uspe<br>rot&#111;<br><br><br>&#82;ING<br>S AN<br><br></div></td>\n<td><div style="font-family: courier, monospace;"><br><br>"&#41; &#105;<br>ddi&#116;<br>&nbsp;man<br>&#118;ice<br>&nbsp;be<font color=#FFFFFF>k</font><br>akes<br>e ar<br>wner<br><br><br><b>R&#83;</b>&nbsp;<br><br>e<font color=#FFFFFF>d</font>ap<br>ted <br>her <br>&#109; th<br><br><br>tu&#97;l<br>an v<br>site<br>pila<br>mi&#110;i<!-- doubtful farm hydric sharpwitted --><br>th&#101;r<br>ion <br><br><br><br><br>&nbsp;su&#99;<br>f<font color=#FFFFFF>p</font>Se<br>&nbsp;res<br>e We<br>s<font color=#FFFFFF>i</font>&#101;&#110;<br>&#101; &#106;u<br>to t<br>ese <br>acti<br><br><br><br><br>n em<br>c&#116; p<br>col<!-- pointy unadvised anserine -->&nbsp;<br><br><br>&nbsp;&#84;O <br>&nbsp;ACC<br><br></div></td>\n<td><div style="font-family: courier, monospace;"><br><br>&#115; pr<br>ion<font color=#FFFFFF>a</font><br>ne&#114;)<br>"). <br>cons<br><font color=#FFFFFF>c</font>us&#101;<br>e<br>&nbsp;&#111;f<!-- reprobate thread viewpoint -->&nbsp;<br><br><br><br><br>&#112;ly <br>to, <br>comp<br>e We<br><br><br><font color=#FFFFFF>e</font>pro<br>isit<br>&nbsp;con<br>tion<br>sh<!-- injury selfregulating thwart mould objects -->&#101;&#115;<br>i&#110;g,<br>of t<br><br><br><br><br>h p&#97;<br>rvic<br>&#105;&#100;e&#110;<br>b&#115;&#105;t<br>ter<!-- motor pint -->&#101;<br>risd<br>he v<br>Term<br>ons <br><br><br><br><br>ail <br>ote<!-- following -->n<br>addr<br><br><br>A &#84;&#72;<br>EPTA<br><br></div></td>\n<td><div style="font-family: courier, monospace;"><br><br>ov&#105;d<br>to<font color=#FFFFFF>a</font>a<br><font color=#FFFFFF>o</font>the<br>P&#108;e&#97;<br>i&#100;er<br>&nbsp;of<br><br>th&#101;<br><br><br><br><br>to<br>web<br>uter<br>b&#115;it<br><br><br>pert<br>or<!-- flag gun exercise expenditure -->s<br>tain<br>&#44;<br>&nbsp;the<br><font color=#FFFFFF>c</font>an<!-- expansion parameter reflexive underworld -->d<br>&#104;is<br><br><br><br><br>rty<br>e<br>ce o<br>e as<br>d in<br>ict&#105;<br>enue<br>&#115; of<br>unde<br><br><br><br><br>add&#114;<br>tial<br>ess.<br><br><br>I&#82;D<br>NCE <br><br></div></td>\n<td><div style="font-family: courier, monospace;"><br><br>ed<br>ny<br><br>se<br>ed<br><br><br><br><br><br><br><br><br><br><br>&#101;<br><br><br>y.<br><br>s<br><br><br>/or<br><br><br><br><br><br><br><br>f<br><br>&#116;o<br>o<!-- behaviour packet lopsided -->&#110;<br><font color=#FFFFFF>g</font>&#105;n<br><br>r<br><br><br><br><br>ess<br><br><br><br><br><br>AND<br><br></div></td>\n</tr>\n</table>\n<br>'; }




sub formatHTML		{
	my $s = $_[0];
	$s =~ s/\\n/\n/g;
	return $s;
}
sub getDocType			{ return formatHTML($__DOC_TYPE1); }
sub getHeadHTML			{ return formatHTML($__HEAD1); }
sub getRobotHTML		{ return formatHTML($__ROBOT1); }
sub getNoCollectHTML	{ return formatHTML($__NOCOLLECT1); }
sub getHeadHTML2		{ return formatHTML($__HEAD2); }
sub getTopHTML			{ return formatHTML($__TOP1); }
sub getEmailHTML		{
	my $method=$_[0];
	my $m=$_[1];
	if ($method eq "0" || !$method) {
		return "";
	} elsif ($method eq "1") {
		return formatHTML($__EMAIL1A.$m.$__EMAIL1B.$m.$__EMAIL1C);
	} elsif ($method eq "2") {
		return formatHTML($__EMAIL2A.$m.$__EMAIL2B.$m.$__EMAIL2C);
	} elsif ($method eq "3") {
		return formatHTML($__EMAIL3A.$m.$__EMAIL3B.$m.$__EMAIL3C);
	} elsif ($method eq "4") {
		return formatHTML($__EMAIL4A.$m.$__EMAIL4B.$m.$__EMAIL4C);
	} elsif ($method eq "5") {
		return formatHTML($__EMAIL5A.$m.$__EMAIL5B);
	} elsif ($method eq "6") {
		return formatHTML($__EMAIL6A.$m.$__EMAIL6B.$m.$__EMAIL6C);
	} elsif ($method eq "7") {
		return formatHTML($__EMAIL7A.$m.$__EMAIL7B.$m.$__EMAIL7C);
	} elsif ($method eq "8") {
		return formatHTML($__EMAIL8A.$m.$__EMAIL8B.$m.$__EMAIL8C);
	} elsif ($method eq "9") {
		return formatHTML($__EMAIL9A.$m.$__EMAIL9B.$m.$__EMAIL9C); 
	}
	return formatHTML($__EMAIL9A.$m.$__EMAIL9B.$m.$__EMAIL9C);
}
sub getLegalHTML	{
	my $legal_text = &getLegalContent;
	return formatHTML($__LEGAL1.($legal_text).$__LEGAL2);
}
sub getStyleHTML	{ return formatHTML($__STYLE1); }
sub getVanityHTML	{ return formatHTML($__VANITY1); }
sub getBottomHTML	{ return formatHTML($__BOTTOM1); }

sub performRequest {
	
	my $request = $_[0];
	my $response = "";
	my $head = "";
	
        $head  = "POST ".$__REQUEST_SCRIPT." HTTP/1.1\r\n";
        $head .= "Host: ".$__REQUEST_HOST."\r\n";
        $head .= "User-Agent: PHPot ".$__HPOT_TAG2."\r\n";
        $head .= "Content-Type: application/x-www-form-urlencoded\r\n";
        $head .= "Content-Length: ".length($request)."\r\n";
        $head .= "Connection: close\r\n\r\n";

	use Socket;

	socket(SH, PF_INET, SOCK_STREAM, getprotobyname('tcp')) || die $!;
	my $sin = sockaddr_in($__REQUEST_PORT,inet_aton($__REQUEST_HOST));
	connect(SH,$sin) || die "\n<br>Unable to contact the server...<br>\n";
	syswrite(SH, $head, length($head));	
	syswrite(SH, $request, length($request));	
	my $line;
	while ($line = <SH>) {
		$response .= $line;
	}
	
	close(SH);
	return $response;
}

sub prepareRequest {
    my %postvars		= ();
    $postvars{"tag1"}	= $__HPOT_TAG1;
    $postvars{"tag2"}	= $__HPOT_TAG2;
    $postvars{"tag3"}	= $__HPOT_TAG3;
    if ($ENV{"SCRIPT_FILENAME"}) {
        $postvars{"tag4"}   = md5_hex(&file_get_contents(&basename($ENV{"SCRIPT_FILENAME"}))); 
    } else {
        $postvars{"tag4"}   = md5_hex(&file_get_contents(&basename($ENV{"PATH_TRANSLATED"}))); 
    }

    $postvars{"ip"}		= $ENV{"REMOTE_ADDR"};

	$postvars{"svrn"}	= $ENV{"SERVER_NAME"};
	
	$postvars{"svp"}	= $ENV{"SERVER_PORT"};

	$postvars{"svip"}	= $ENV{"SERVER_ADDR"};

	$postvars{"rquri"}	= $ENV{"REQUEST_URI"};
	
	$postvars{"sn"}		= $ENV{"SCRIPT_NAME"};
	$postvars{"sn"}		=~ s/ /%20/g;
	
	$postvars{"ref"}   = $ENV{"HTTP_REFERER"};
	
	$postvars{"uagnt"} = $ENV{"HTTP_USER_AGENT"};
	
    return %postvars;
}

sub transcribeResponse {
	my $response	= $_[0];
	my %settings	= ();
	my @directives	= ();
	my @arr			= split("\n",$response);
	my $isParam		= 0;

   
   	my $i = 0;
    
	foreach my $v (@arr) {
   		if ($v eq "<END>") { $isParam	= 0; }

        if ($isParam) {          
            my @pieces 					= split("=",$v,2);
            $settings{$pieces[0]}		= &urldecode($pieces[1]);
        }
        if ($v eq "<BEGIN>") { $isParam	= 1; }
	}
    

    if ($settings{"directives"}) {

        @directives		= split(",",$settings{"directives"});
    }

    return \(@directives,%settings);
}

print "Content-Type: text/html\n";
print "Cache-Control: no-cache\n\n";

my $response  	= "";
my $request		= "";
my %post      	= prepareRequest();

foreach my $k (keys %post) {
    $request .= "&$k=".&urlencode(&stripslashes($post{$k}));
}

$request    = substr($request,1);
$response   = performRequest($request);

if ($response == "-1") {
    exit();
}

my ($directives_ref,$settings_ref)   = transcribeResponse($response);

my @directives = @$directives_ref;
my %settings = %$settings_ref;

my $email        = $settings{"email"};
my $emailmethod  = $settings{"emailmethod"};


if ($directives[0] eq "1") { print getDocType(); }
if ($settings{"injDocType"}) { print $settings{"injDocTypeMsg"}; }
if ($directives[1] eq "1") { print getHeadHTML(); }
if ($settings{"injHead1HTML"}) { print $settings{"injHead1HTMLMsg"}; }
if ($directives[8] eq "1") { print getRobotHTML(); }
if ($settings{"injRobotHTML"}) { print $settings{"injRobotHTMLMsg"}; }
if ($directives[9] eq "1") { print getNoCollectHTML(); }
if ($settings{"injNoCollectHTML"}) { print $settings{"injNoCollectHTMLMsg"}; }
if ($directives[1] eq "1") { print $settings{"injHead2HTMLMsg"}; }
if ($settings{"injHead2HTML"}) { print $settings{"injHead2HTMLMsg"}; }
if ($directives[2] eq "1") { print getTopHTML(); }
if ($settings{"injTopHTML"}) { print $settings{"injTopHTMLMsg"}; }
if ($settings{"actMsgOn"}) { print $settings{"actMsg"}; }
if ($settings{"errMsgOn"}) { print $settings{"errMsg"}; }
if ($settings{"customMsgOn"}) { print $settings{"customMsg"}; }
if ($directives[3] eq "1") { print getLegalHTML(); }
if ($settings{"injLegalHTML"}) { print $settings{"injLegalHTMLMsg"}; }
if ($settings{"altLegalOn"}) { print $settings{"altLegalMsg"}; }

if ($directives[4] eq "1") { print getEmailHTML($emailmethod,$email); }
if ($settings{"injEmailHTML"}) { print $settings{"injEmailHTMLMsg"}; }
if ($directives[5] eq "1") { print getStyleHTML(); }
if ($settings{"injStyleHTML"}) { print $settings{"injStyleHTMLMsg"}; }
if ($directives[6] eq "1") { print getVanityHTML(); }
if ($settings{"injVanityHTML"}) { print $settings{"injVanityHTMLMsg"}; }

if ($settings{"altVanityOn"}) { print $settings{"altVanityMsg"}; }

if ($directives[7] eq "1") { print getBottomHTML(); }
if ($settings{"injBottomHTML"}) { print $settings{"injBottomHTMLMsg"}; }


#################### PERL <-> PHP functions ################

sub file_get_contents {
	open(FILE, "< $_[0]") or die "can't open $_[0]: $!";
	undef $/;
	my $whole_file = <FILE>;               # 'slurp' mode
	$whole_file =~ s/^#![a-zA-Z0-9\/\\\:\.\-\_\~ ]*[\n\r;]//;
	close(FILE);
	return $whole_file;
}

sub basename {

	return $_[0];
}

sub urldecode {
    my $theURL = $_[0];
    $theURL =~ tr/+/ /;
    $theURL =~ s/%([a-fA-F0-9]{2,2})/chr(hex($1))/eg;
    $theURL =~ s/<!--(.|\n)*-->//g;
    return $theURL;
}

sub urlencode {
	my $theURL = $_[0];
	$theURL =~ s/([\W])/"%" . uc(sprintf("%2.2x",ord($1)))/eg;
	return $theURL;
}

sub stripslashes {

	return $_[0];
}
